      SUBROUTINE SETHEX(N1,NGAUSS,NC,PSIC,NN,PSI,W,IUT0,IERR)
      IMPLICIT NONE

***** PARAMETERS *****
      INTEGER N1
      
***** DEFINE ARGUMENTS *****
      INTEGER NGAUSS
      REAL*8 NC(N1)
      REAL*8 PSIC(3,N1)
      REAL*8 NN(N1,NGAUSS)
      REAL*8 PSI(3,N1,NGAUSS)
      REAL*8 W(NGAUSS)
      
***** OBJECTS *****
      REAL*8 XI(3,NGAUSS)
      INTEGER M
      REAL*8 P(99)
      REAL*8 S(99)
      INTEGER IUT0,IERR      
      INTEGER IP
      INTEGER I, J, K

****************************
***** N, PSI AT CENTER *****
****************************
      XI(1,1)=0.
      XI(2,1)=0.
      XI(3,1)=0.
      NC(1)=0.125*(1.-XI(1,1))*(1.-XI(2,1))*(1.-XI(3,1))
      NC(2)=0.125*(1.+XI(1,1))*(1.-XI(2,1))*(1.-XI(3,1))
      NC(3)=0.125*(1.+XI(1,1))*(1.+XI(2,1))*(1.-XI(3,1))
      NC(4)=0.125*(1.-XI(1,1))*(1.+XI(2,1))*(1.-XI(3,1))
      NC(5)=0.125*(1.-XI(1,1))*(1.-XI(2,1))*(1.+XI(3,1))
      NC(6)=0.125*(1.+XI(1,1))*(1.-XI(2,1))*(1.+XI(3,1))
      NC(7)=0.125*(1.+XI(1,1))*(1.+XI(2,1))*(1.+XI(3,1))
      NC(8)=0.125*(1.-XI(1,1))*(1.+XI(2,1))*(1.+XI(3,1))
C
      PSIC(1,1)=-0.125*(1.-XI(2,1))*(1.-XI(3,1))
      PSIC(1,2)=+0.125*(1.-XI(2,1))*(1.-XI(3,1))
      PSIC(1,3)=+0.125*(1.+XI(2,1))*(1.-XI(3,1))
      PSIC(1,4)=-0.125*(1.+XI(2,1))*(1.-XI(3,1))
      PSIC(1,5)=-0.125*(1.-XI(2,1))*(1.+XI(3,1))
      PSIC(1,6)=+0.125*(1.-XI(2,1))*(1.+XI(3,1))
      PSIC(1,7)=+0.125*(1.+XI(2,1))*(1.+XI(3,1))
      PSIC(1,8)=-0.125*(1.+XI(2,1))*(1.+XI(3,1))
C      
      PSIC(2,1)=-0.125*(1.-XI(3,1))*(1.-XI(1,1))
      PSIC(2,2)=-0.125*(1.-XI(3,1))*(1.+XI(1,1))
      PSIC(2,3)=+0.125*(1.-XI(3,1))*(1.+XI(1,1))
      PSIC(2,4)=+0.125*(1.-XI(3,1))*(1.-XI(1,1))
      PSIC(2,5)=-0.125*(1.+XI(3,1))*(1.-XI(1,1))
      PSIC(2,6)=-0.125*(1.+XI(3,1))*(1.+XI(1,1))
      PSIC(2,7)=+0.125*(1.+XI(3,1))*(1.+XI(1,1))
      PSIC(2,8)=+0.125*(1.+XI(3,1))*(1.-XI(1,1))
      
      PSIC(3,1)=-0.125*(1.-XI(1,1))*(1.-XI(2,1))
      PSIC(3,2)=-0.125*(1.+XI(1,1))*(1.-XI(2,1))
      PSIC(3,3)=-0.125*(1.+XI(1,1))*(1.+XI(2,1))
      PSIC(3,4)=-0.125*(1.-XI(1,1))*(1.+XI(2,1))
      PSIC(3,5)=+0.125*(1.-XI(1,1))*(1.-XI(2,1))
      PSIC(3,6)=+0.125*(1.+XI(1,1))*(1.-XI(2,1))
      PSIC(3,7)=+0.125*(1.+XI(1,1))*(1.+XI(2,1))
      PSIC(3,8)=+0.125*(1.-XI(1,1))*(1.+XI(2,1))
C
************************************
***** SETUP M, P, S, FOR XI, W *****
************************************

      IF(NGAUSS.EQ.8) THEN        !2X2X2
         M=2
         P(1)=-SQRT(1./3.); S(1)=1.
         P(2)=+SQRT(1./3.); S(2)=1.
C         
      ELSE IF(NGAUSS.EQ.27) THEN   !3X3X3
         M=3
         P(1)=-SQRT(3./5.); S(1)=5./9.
         P(2)=0.;           S(2)=8./9.
         P(3)=+SQRT(3./5.); S(3)=5./9.
C         
      ELSE IF(NGAUSS.EQ.64) THEN   !4X4X4
         M=4
         P(1)=-0.861136311594053; S(1)=0.347854845137454
         P(2)=-0.339981043584856; S(2)=0.652145154862546
         P(3)=+0.339981043584856; S(3)=0.652145154862546
         P(4)=+0.861136311594053; S(4)=0.347854845137454
C
      ELSE IF(NGAUSS.EQ.125) THEN  !5X5X5
         M=5
         P(1)=-0.906179845938664; S(1)=0.236926885056189
         P(2)=-0.538469310105683; S(2)=0.478628670499366
         P(3)=0.;                 S(3)=0.568888888888889
         P(4)=+0.538469310105683; S(4)=0.478628670499366
         P(5)=+0.906179845938664; S(5)=0.236926885056189
C
      ELSE IF(NGAUSS.EQ.216) THEN  !6X6X6
         M=6
         P(1)=-0.932469614203152; S(1)=0.171324492379170
         P(2)=-0.661209386466265; S(2)=0.360761573048139
         P(3)=-0.238619186083197; S(3)=0.467913934572691
         P(4)=+0.238619186083197; S(4)=0.467913934572691
         P(5)=+0.661209386466265; S(5)=0.360761573048139
         P(6)=+0.932469614203152; S(6)=0.171324492379170
C         
      ELSE IF(NGAUSS.EQ.343) THEN  !7X7X7
         M=7
         P(1)=-0.949107912342758; S(1)=0.129484966168870
         P(2)=-0.741531185599394; S(2)=0.279705391489277
         P(3)=-0.405845151377397; S(3)=0.381830050505119
         P(4)=0.;                 S(4)=0.417959183673469
         P(5)=+0.405845151377397; S(5)=0.381830050505119
         P(6)=+0.741531185599394; S(6)=0.279705391489277
         P(7)=+0.949107912342758; S(7)=0.129484966168870
C         
      ELSE
         WRITE(IUT0,*) "[ERROR]@SETUP_HEX:"
         WRITE(IUT0,*) "NGAUSS=", NGAUSS, "IS NOT SUPPORTED."
         IERR=1
      ENDIF
C
***********************
***** SETUP XI, W *****
***********************
      DO 1000 K=1,M
          DO 1100 J=1,M
              DO 1200 I=1,M
                  IP =M*M*(K-1)+M*(J-1)+I
                  XI(1,IP)=P(I)
                  XI(2,IP)=P(J)
                  XI(3,IP)=P(K)
                  W(IP)=S(I)*S(J)*S(K)
 1200         CONTINUE
 1100     CONTINUE
 1000 CONTINUE
******************
***** N, PSI *****
******************
      DO IP=1,NGAUSS
          NN(1,IP)=0.125*(1.-XI(1,IP))*(1.-XI(2,IP))*(1.-XI(3,IP))
          NN(2,IP)=0.125*(1.+XI(1,IP))*(1.-XI(2,IP))*(1.-XI(3,IP))
          NN(3,IP)=0.125*(1.+XI(1,IP))*(1.+XI(2,IP))*(1.-XI(3,IP))
          NN(4,IP)=0.125*(1.-XI(1,IP))*(1.+XI(2,IP))*(1.-XI(3,IP))
          NN(5,IP)=0.125*(1.-XI(1,IP))*(1.-XI(2,IP))*(1.+XI(3,IP))
          NN(6,IP)=0.125*(1.+XI(1,IP))*(1.-XI(2,IP))*(1.+XI(3,IP))
          NN(7,IP)=0.125*(1.+XI(1,IP))*(1.+XI(2,IP))*(1.+XI(3,IP))
          NN(8,IP)=0.125*(1.-XI(1,IP))*(1.+XI(2,IP))*(1.+XI(3,IP))
C
          PSI(1,1,IP)=-0.125*(1.-XI(2,IP))*(1.-XI(3,IP))
          PSI(1,2,IP)=+0.125*(1.-XI(2,IP))*(1.-XI(3,IP))
          PSI(1,3,IP)=+0.125*(1.+XI(2,IP))*(1.-XI(3,IP))
          PSI(1,4,IP)=-0.125*(1.+XI(2,IP))*(1.-XI(3,IP))
          PSI(1,5,IP)=-0.125*(1.-XI(2,IP))*(1.+XI(3,IP))
          PSI(1,6,IP)=+0.125*(1.-XI(2,IP))*(1.+XI(3,IP))
          PSI(1,7,IP)=+0.125*(1.+XI(2,IP))*(1.+XI(3,IP))
          PSI(1,8,IP)=-0.125*(1.+XI(2,IP))*(1.+XI(3,IP))
C      
          PSI(2,1,IP)=-0.125*(1.-XI(3,IP))*(1.-XI(1,IP))
          PSI(2,2,IP)=-0.125*(1.-XI(3,IP))*(1.+XI(1,IP))
          PSI(2,3,IP)=+0.125*(1.-XI(3,IP))*(1.+XI(1,IP))
          PSI(2,4,IP)=+0.125*(1.-XI(3,IP))*(1.-XI(1,IP))
          PSI(2,5,IP)=-0.125*(1.+XI(3,IP))*(1.-XI(1,IP))
          PSI(2,6,IP)=-0.125*(1.+XI(3,IP))*(1.+XI(1,IP))
          PSI(2,7,IP)=+0.125*(1.+XI(3,IP))*(1.+XI(1,IP))
          PSI(2,8,IP)=+0.125*(1.+XI(3,IP))*(1.-XI(1,IP))
C      
          PSI(3,1,IP)=-0.125*(1.-XI(1,IP))*(1.-XI(2,IP))
          PSI(3,2,IP)=-0.125*(1.+XI(1,IP))*(1.-XI(2,IP))
          PSI(3,3,IP)=-0.125*(1.+XI(1,IP))*(1.+XI(2,IP))
          PSI(3,4,IP)=-0.125*(1.-XI(1,IP))*(1.+XI(2,IP))
          PSI(3,5,IP)=+0.125*(1.-XI(1,IP))*(1.-XI(2,IP))
          PSI(3,6,IP)=+0.125*(1.+XI(1,IP))*(1.-XI(2,IP))
          PSI(3,7,IP)=+0.125*(1.+XI(1,IP))*(1.+XI(2,IP))
          PSI(3,8,IP)=+0.125*(1.-XI(1,IP))*(1.+XI(2,IP))
      ENDDO
C
      RETURN
      END
